# 本地开发环境变量示例
# 复制此文件为 .env 并填写实际值

# ========== 数据存储配置 ==========
DATABASE_STORAGE=bitable

# ========== 应用配置 ==========
PORT=3000
NODE_ENV=development

# ========== 飞书开放平台配置 ==========
FEISHU_APP_ID=your_app_id_here
FEISHU_APP_SECRET=your_app_secret_here
FEISHU_BASE_URL=https://open.feishu.cn

# ========== Anthropic AI 配置 ==========
APP_ANTHROPIC_API_KEY=your_api_key_here
APP_ANTHROPIC_BASE_URL=https://ai-router.anker-in.com/v1
APP_ANTHROPIC_MODEL=us.anthropic.claude-sonnet-4-5-20250929-v1:0

# ========== SMTP 邮件配置(可选) ==========
SMTP_HOST=smtp.feishu.cn
SMTP_PORT=465
SMTP_SECURE=true
SMTP_USER=your_email@anker.io
SMTP_PASSWORD=your_password_here
SMTP_FROM_NAME=Anita-Web-Sentinel
SMTP_FROM_EMAIL=your_email@anker.io

# ========== 截图存储 ==========
SCREENSHOT_DIR=./backend/screenshots

# ========== 前端 URL 配置 ==========
# 用于邮件中的报告链接,生产环境请设置为实际域名
APP_URL=http://10.5.3.150:10038

# ========== 性能测试 API 配置 ==========
# WebPageTest API (用于真实设备性能测试)
# 获取 API Key: https://www.webpagetest.org/getkey.php
WEBPAGETEST_API_KEY=your_webpagetest_api_key_here

# PageSpeed Insights API (用于 Google Lighthouse 性能测试)
# 获取 API Key: https://developers.google.com/speed/docs/insights/v5/get-started
# 注意: 没有 API Key 时每日限制 25 次请求/IP
PAGESPEED_API_KEY=your_pagespeed_api_key_here

# ========== MCP Server 配置 (买赠规则查询工具) ==========
# MCP 服务器 URL 和认证 Token
# 用于买赠规则状态查询和 Metafield 检查
MCP_SERVER_URL=http://beta-dtc-mcp.anker-in.com/mcp/tc_y7odih2ds
MCP_SERVER_TOKEN=mcpt_dc0f56690e00e98e7342e3ebf9c20f4a887a50c61eba20f0a888253495c47ec0

# ========== Redis 缓存配置 ==========
# Redis 服务器 URL,格式: redis://[user:password@]host[:port]
# 默认: redis://localhost:6379
REDIS_URL=redis://localhost:6379
# Redis 连接超时(毫秒)
REDIS_CONNECT_TIMEOUT=5000
# 是否启用 Redis 缓存(默认 true)
REDIS_ENABLED=true

# ========== 巡检任务并发配置 ==========
# 同时测试的最大 URL 数量(默认 3)
# 建议值: 2-5,过高可能导致浏览器资源竞争
MAX_CONCURRENT_URLS=3

# ========== 任务队列配置 ==========
# 系统使用双队列设计:
# - 高优先级队列: 用户触发的测试(响应式测试、网页质量测试)立即执行
# - 低优先级队列: 定时巡检任务串行执行,避免资源抢占
# 队列状态查询: GET /api/v1/system/queue-status
# 队列健康检查: GET /api/v1/system/health

# ========== 飞书多维表格配置 ==========
# 折扣规则查询报告表 ID
FEISHU_TABLE_DISCOUNT_REPORTS=

# ========== 浏览器池动态扩缩容配置 ==========
# 初始浏览器池大小
BROWSER_POOL_SIZE=5
# 最小浏览器池大小(缩容下限)
MIN_BROWSER_POOL_SIZE=3
# 最大浏览器池大小(扩容上限)
MAX_BROWSER_POOL_SIZE=10
# 获取浏览器超时时间(毫秒),防止无限等待
ACQUIRE_TIMEOUT=120000
# 扩容阈值:等待队列长度达到此值时自动扩容
SCALE_UP_THRESHOLD=3
# 缩容阈值:浏览器空闲时间超过此值时自动缩容(毫秒)
SCALE_DOWN_THRESHOLD=60000
# 健康检查间隔(毫秒),从60秒优化为30秒
HEALTH_CHECK_INTERVAL=30000
# 浏览器最大存活时间(毫秒),默认30分钟,防止内存泄漏
MAX_BROWSER_AGE=1800000
# 浏览器最大使用次数,默认30次,超过后自动替换
MAX_BROWSER_USAGE=30
